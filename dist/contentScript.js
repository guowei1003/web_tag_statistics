(()=>{"use strict";function t(t){const e=[];let a=t;for(;a&&a!==document.body;){let t=a.tagName?a.tagName.toLowerCase():"",s=0,n=a.previousSibling;for(;n;)1===n.nodeType&&n.tagName&&n.tagName.toLowerCase()===t&&s++,n=n.previousSibling;let o=s?`[${s+1}]`:"";e.unshift(`${t}${o}`),a=a.parentNode}return`/${e.join("/")}`}chrome.runtime.onMessage.addListener(((e,a,s)=>("calc"===e.type?s((()=>{const t=document.getElementsByTagName("*"),e=document.getElementsByTagName("iframe"),a=document.getElementsByTagName("meta"),s=document.getElementsByTagName("script"),n=document.getElementsByTagName("style"),o={totalTags:t.length,totalIframeTags:e.length,totalMetaTags:a.length,totalScriptTags:s.length,totalCssTags:n.length},i={};for(let e=0;e<t.length;e++){const a=t[e],s=a.tagName;if(i[s]?i[s]+=1:i[s]=1,"link"===s){const t=a.getAttribute("href");t&&(t.split("?")[0].endsWith(".css")?o.totalCssTags+=1:t.split("?")[0].endsWith(".js")&&(o.totalScriptTags+=1))}}const l=Object.entries(i).map((([t,e])=>({key:t,value:e}))).sort(((t,e)=>e.value-t.value)).slice(0,10);return o.tagList=l,o})()):"checkAd"===e.type&&s(function(){const e=[],a=document.getElementsByTagName("*");for(let s=0;s<a.length;s++){const n=a[s],o=n.tagName.toLowerCase();if("iframe"===o||"img"===o){const a=n.getAttribute("src");a&&a.startsWith("http")&&a.split("/")[2].includes("ad")&&e.push({tag:o,type:"src",xpath:t(n),value:a.split("/")[2]})}else if("span"===o||"div"===o){const a=n.textContent;"广告"!==a&&"ad"!==a.toLowerCase()&&"ads"!==a.toLowerCase()||e.push({tag:o,type:"text",xpath:t(n),value:a})}}return e}()),!0))),chrome.runtime.sendMessage({type:"pageLoadTime",value:{time:performance.timeOrigin,url:window.location.href}})})();